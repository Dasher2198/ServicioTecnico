<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REVTEC - Panel Principal</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

            .header-logo h1 {
                font-size: 1.5rem;
                color: #1e293b;
                font-weight: 700;
            }

            .header-logo img {
                width: 45px;
                height: 45px;
                border-radius: 50%;
                object-fit: cover;
            }

        .nav-menu {
            list-style: none;
            display: flex;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.9);
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            margin: 1rem 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

            .nav-menu a {
                text-decoration: none;
                color: #475569;
                font-weight: 500;
                padding: 0.5rem 1rem;
                border-radius: 6px;
                transition: all 0.2s;
                cursor: pointer;
            }

                .nav-menu a:hover {
                    background: #ef4444;
                    color: white;
                }

        .welcome-section {
            text-align: center;
            padding: 2rem;
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
            background: rgba(255, 255, 255, 0.9);
            margin: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .debug-info {
            background: rgba(16, 185, 129, 0.1);
            padding: 1rem;
            margin: 1rem 2rem;
            border-radius: 8px;
            border-left: 4px solid #10b981;
            font-family: monospace;
            font-size: 0.9rem;
            display: none;
        }

        .panel-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            display: none;
        }

            .panel-section.active {
                display: block;
            }

        .panel-title {
            margin-bottom: 1.5rem;
            color: #1e293b;
            font-weight: 700;
            font-size: 1.5rem;
        }

        .panel-links {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .panel-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            text-decoration: none;
            color: #374151;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

            .panel-link:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            }

            .panel-link.cliente:hover {
                background: #059669;
                color: white;
                border-color: #059669;
            }

            .panel-link.tecnico:hover {
                background: #7c3aed;
                color: white;
                border-color: #7c3aed;
            }

        .summary-section {
            margin-top: 2rem;
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

            .summary-section.cliente {
                background: rgba(16, 185, 129, 0.1);
                border-left-color: #10b981;
            }

            .summary-section.tecnico {
                background: rgba(139, 92, 246, 0.1);
                border-left-color: #8b5cf6;
            }

        .summary-title {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .stat-card {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #64748b;
            font-weight: 500;
        }

        .citas-section {
            margin-top: 1.5rem;
        }

        .citas-title {
            margin: 0 0 1rem 0;
            color: #1e293b;
            font-size: 1.1rem;
        }

        .cita-card {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 0.75rem;
            border-left: 4px solid #3b82f6;
        }

        .cita-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .cita-vehicle {
            font-weight: 600;
            color: #1e293b;
        }

        .cita-time {
            background: #3b82f6;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .cita-details {
            font-size: 0.9rem;
            color: #64748b;
        }

        .cita-observations {
            font-size: 0.85rem;
            color: #64748b;
            margin-top: 0.5rem;
            font-style: italic;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
                flex-direction: column;
                gap: 0.5rem;
            }

            .nav-menu {
                margin: 0.5rem 1rem;
                justify-content: center;
            }

            .panel-section {
                margin: 1rem;
                padding: 1.5rem;
            }

            .panel-links {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-logo">
            <img src="39d17164-550e-4c01-a02a-60937f850308.jpg" alt="Logo REVTEC">
            <h1>REVTEC</h1>
        </div>
    </header>

    <ul class="nav-menu">
        <li><a href="#" onclick="cerrarSesion()"> Cerrar Sesión</a></li>
    </ul>

    <div id="bienvenida" class="welcome-section">
        <span> Cargando información...</span>
    </div>

    <!-- Información de Debug -->
    <div id="debugInfo" class="debug-info">
        <strong> Debug:</strong> <span id="debugText">Verificando usuario...</span>
    </div>

    <!-- Panel del Cliente -->
    <div class="panel-section" id="panelCliente">
        <h2 class="panel-title"> Panel del Cliente</h2>

        <div class="panel-links">
            <a href="RegistroVehiculo.html" class="panel-link cliente">
                 Registrar Vehículo
            </a>
            <a href="MisVehiculos.html" class="panel-link cliente">
                 Mis Vehículos
            </a>
            <a href="AgendarCita.html" class="panel-link cliente">
                 Agendar Cita
            </a>
            <a href="HistorialInspecciones.html" class="panel-link cliente">
                 Ver Historial Inspecciones
            </a>
        </div>

        <div class="summary-section cliente">
            <h3 class="summary-title"></h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #3b82f6;">3</div>
                    <div class="stat-label">Mis Vehículos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #f59e0b;">1</div>
                    <div class="stat-label">Citas Pendientes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #8b5cf6;">8</div>
                    <div class="stat-label">Inspecciones</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #10b981;">2</div>
                    <div class="stat-label">Certificados Válidos</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Panel del Técnico -->
    <div class="panel-section" id="panelTecnico">
        <h2 class="panel-title"> Panel del Técnico</h2>

        <div class="panel-links">
            <a href="RegistrarInspeccion.html" class="panel-link tecnico">
                 Registrar Inspección
            </a>
            <a href="HistorialInspecciones.html" class="panel-link tecnico">
                 Ver Mis Inspecciones
            </a>
        </div>

        <div class="summary-section tecnico">
            <h3 class="summary-title"> Actividad del Día</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #3b82f6;">5</div>
                    <div class="stat-label">Citas Hoy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #8b5cf6;">2</div>
                    <div class="stat-label">Inspecciones Hoy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #10b981;">2</div>
                    <div class="stat-label">Aprobadas Hoy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"></div>
                    <div class="stat-value" style="color: #f59e0b;">87</div>
                    <div class="stat-label">Total Inspecciones</div>
                </div>
            </div>
        </div>

        <div class="citas-section">
            <h3 class="citas-title"> Citas de Hoy</h3>

            <div class="cita-card">
                <div class="cita-header">
                    <div class="cita-vehicle"> ABC123 - Toyota Corolla</div>
                    <div class="cita-time"> 09:00</div>
                </div>
                <div class="cita-details"> REVTEC San José Centro</div>
                <div class="cita-observations"> Primera inspección del vehículo</div>
            </div>

            <div class="cita-card">
                <div class="cita-header">
                    <div class="cita-vehicle"> XYZ789 - Honda Civic</div>
                    <div class="cita-time"> 11:30</div>
                </div>
                <div class="cita-details"> REVTEC San José Centro</div>
            </div>

            <div class="cita-card">
                <div class="cita-header">
                    <div class="cita-vehicle"> DEF456 - Nissan Sentra</div>
                    <div class="cita-time"> 14:00</div>
                </div>
                <div class="cita-details"> REVTEC San José Centro</div>
                <div class="cita-observations"> Revisión de sistema de frenos</div>
            </div>

            <div class="cita-card">
                <div class="cita-header">
                    <div class="cita-vehicle"> GHI789 - Hyundai Elantra</div>
                    <div class="cita-time"> 15:30</div>
                </div>
                <div class="cita-details"> REVTEC San José Centro</div>
            </div>

            <div class="cita-card">
                <div class="cita-header">
                    <div class="cita-vehicle"> JKL012 - Mazda 3</div>
                    <div class="cita-time"> 16:45</div>
                </div>
                <div class="cita-details"> REVTEC San José Centro</div>
                <div class="cita-observations"> Inspección de seguimiento</div>
            </div>
        </div>
    </div>

    <script>
        function cerrarSesion() {
            if (confirm('¿Estás seguro de que deseas cerrar sesión?')) {
                localStorage.removeItem('usuarioActual');
                window.location.href = 'Login.html';
            }
        }

        function mostrarDebug(mensaje) {
            document.getElementById('debugText').textContent = mensaje;
            document.getElementById('debugInfo').style.display = 'block';
            console.log(' DEBUG:', mensaje);
        }

        function inicializar() {
            console.log(' Inicializando panel principal...');
            mostrarDebug('Verificando sesión de usuario...');

            try {
                // Verificar localStorage
                const usuarioData = localStorage.getItem('usuarioActual');

                if (!usuarioData) {
                    mostrarDebug(' No hay datos de usuario');
                    setTimeout(() => window.location.href = 'Login.html', 2000);
                    return;
                }

                const usuario = JSON.parse(usuarioData);
                mostrarDebug(` Usuario: ${usuario.nombre} ${usuario.apellidos} (${usuario.tipoUsuario})`);

                // Mostrar bienvenida
                const horaActual = new Date().getHours();
                let saludo = '';
                if (horaActual < 12) saludo = ' Buenos días';
                else if (horaActual < 18) saludo = ' Buenas tardes';
                else saludo = ' Buenas noches';

                const nombreCompleto = `${usuario.nombre || ''} ${usuario.apellidos || ''}`.trim();
                document.getElementById('bienvenida').innerHTML = `${saludo}, <strong>${nombreCompleto}</strong>!`;

                // Mostrar panel correcto según tipo de usuario
                if (usuario.tipoUsuario === 'cliente') {
                    mostrarDebug(' Mostrando panel de cliente');
                    document.getElementById('panelCliente').classList.add('active');

                    // Ocultar debug después de 3 segundos para clientes
                    setTimeout(() => {
                        document.getElementById('debugInfo').style.display = 'none';
                    }, 3000);

                } else if (usuario.tipoUsuario === 'tecnico') {
                    mostrarDebug(' Mostrando panel de técnico');
                    document.getElementById('panelTecnico').classList.add('active');

                    // Mantener debug visible para técnicos por más tiempo
                    setTimeout(() => {
                        document.getElementById('debugInfo').style.display = 'none';
                    }, 5000);

                } else {
                    mostrarDebug(` Tipo de usuario desconocido: ${usuario.tipoUsuario}`);
                    // Por defecto mostrar panel de cliente
                    document.getElementById('panelCliente').classList.add('active');
                }

                console.log('Panel configurado correctamente');

            } catch (error) {
                console.error(' Error:', error);
                mostrarDebug(` Error: ${error.message}`);

                // Limpiar datos corruptos
                localStorage.removeItem('usuarioActual');
                setTimeout(() => window.location.href = 'Login.html', 3000);
            }
        }

        // Ejecutar al cargar
        document.addEventListener('DOMContentLoaded', inicializar);

        // También ejecutar inmediatamente si ya está cargado
        if (document.readyState !== 'loading') {
            inicializar();
        }
    </script>
</body>
</html>